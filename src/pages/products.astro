---
import ProductHome from '~/components/functional/ProductHome';
import Breadcrumb from '~/components/widgets/Breadcrumb.astro';
import Layout from '~/layouts/PageLayout.astro';

const token = import.meta.env.VITE_API_TOKEN;
const base = import.meta.env.VITE_BACKEND_PATH;

const metadata = {
  title: 'Products',
  items: [],
};

// Category
const brandUrl = base + 'api/v1/brands';
const responseBrd = await fetch(brandUrl, {
  method: 'GET',
  headers: {
    Authorization: 'Bearer ' + token,
    'Content-Type': 'application/json',
  },
});
const brandResponse = await responseBrd.json();
const brands = brandResponse.list;

console.log('brands', brands);

// Category
const categoryUrl = base + 'api/v1/categories';
const responseCat = await fetch(categoryUrl, {
  method: 'GET',
  headers: {
    Authorization: 'Bearer ' + token,
    'Content-Type': 'application/json',
  },
});
const catData = await responseCat.json();
const cat = catData.list;
---

<Layout metadata={metadata}>
  <Breadcrumb>
    Home
    <svg
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 24 24"
      stroke-width="1.5"
      stroke="currentColor"
      class="size-4 inline"
    >
      <path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path>
    </svg>
    <span class="text-gray-900">Products</span>
  </Breadcrumb>

  <!-- component -->
  <div class="w-full px-10 xl:container xl:mx-auto pb-20">
    <ProductHome categories={cat} brands={brands} client:only="react" />
  </div>
</Layout>
